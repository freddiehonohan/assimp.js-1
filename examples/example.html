<!doctype html>
<html>
	<div id="container"></div>
    <input type="file" id="file-input" />
    <input type="file" id="file-output" />
    <h3>Contents of the file:</h3>
    <pre id="file-content"></pre>
  	<script src="../assimp.js"></script>
  	<script>

      // http://stackoverflow.com/questions/3582671/how-to-open-a-local-disk-file-with-javascript
      function readSingleFile(e) {
        var file = e.target.files[0];
        if (!file) {
          return;
        }
        var reader = new FileReader();
        reader.onload = function(e) {
          var contents = e.target.result;
          displayContents(contents);
        };
        reader.readAsText(file);
      }

       function writeSingleFile(e) {
        var file = e.target.files[0];
        if (!file) {
          return;
        }
        var writer = new FileWriter();
        writer.onsave = function(e) {
          //var contents = e.target.result;
          //displayContents(contents);
        };
        writer.writerAsText(file);
      }

      //function displayContents(contents) {
      //  var element = document.getElementById('file-content');
      //  element.innerHTML = contents;
      //}

      document.getElementById('file-input').addEventListener('change', readSingleFile, false);
      document.getElementById('file-output').addEventListener('change', writeSingleFile, false);

  		//var ASSIMPAPP = ASSIMPAPP || {}; // Look into namespace func.
  		//var cam = new ASSIMP.aiCamera();
  		var anim = new Module.aiAnimation();
  		var name1 = new Module.aiString("yo1");
  		anim.setName(name1);
  		var name2 = anim.getName();
  		console.log(name2.str());
  		//var data = name2.getData();
      var modelPath = 'duck.dae';//"../assimp/test/models/Collada/duck.dae"
      //var importer = new Module.Importer();
      //var scene = importer.readFile(modelPath, Module.GetTargetRealtimeMaxQualityFlags());
      //console.log(scene)
      // console.log(scene);

      function displayContents(contents) {
          var importer = new Module.Importer();
          var exporter = new Module.Exporter();
          var scene = importer.readFileFromMemory(contents, Module.GetTargetRealtimeMaxQualityFlags());
          console.log(scene)
          var format = "collada"; //! @see Exporter.cpp line 98 for supported formats.
          var numAnim = scene.getNumAnimations();
          var outStr = exporter.exportToString(scene, format, null);
          var h = 0;
      }

  	</script>
</html>  	